<template name="livechatCurrentChats">
	{{#requiresPermission 'view-livechat-manager'}}
		<fieldset>
			<form class="form-inline" method="post">
				<div class="form-group">
					<label for="name">{{_ "Name"}}</label>
					<input type="text" class="rc-input__element" name="name">
				</div>
				<div class="form-group">
					{{> SearchSelect
						onClickTag=onClickTagAgent
						list=selectedAgents
						onSelect=onSelectAgents
						collection='UserAndRoom'
						subscription='userAutocomplete'
						field='username'
						sort='username'
						label="Served_By"
						placeholder="Served_By"
						name="agent"
						icon="at"
						noMatchTemplate="userSearchEmpty"
						templateItem="popupList_item_default"
						modifier=agentModifier
					}}
				</div>
				<div class="form-group">
					<div class="rc-select">
						<select class="rc-select__element" name="status">
							<option class="rc-select__option" value="">{{_ "All"}}</option>
							<option class="rc-select__option" value="opened">{{_ "Opened"}}</option>
							<option class="rc-select__option" value="closed">{{_ "Closed"}}</option>
						</select>
						{{> icon block="rc-select__arrow" icon="arrow-down" }}
					</div>
				</div>
				<div class="form-group input-daterange">
					<span class="input-group-addon">{{_ "Date_From"}}</span>
					<input type="text" class="form-control rc-input__element" id="from" name="from" >
						<span class="input-group-addon">{{_ "Date_to"}}</span>
					<input type="text" class="form-control rc-input__element" id="to" name="to">
				</div>
				<button class="button">{{_ "Filter"}}</button>
			</form>
		</fieldset>
		<div class="list">
			<table>
				<thead>
					<tr>
						<th width="25%">{{_ "Name"}}</th>
						<th width="25%">{{_ "Served_By"}}</th>
						<th width="15%">{{_ "Started_At"}}</th>
						<th width="15%">{{_ "Last_Message_At"}}</th>
						<th width="20%">{{_ "Status"}}</th>
						<th>&nbsp;</th>
					</tr>
				</thead>
				<tbody>
					{{#each livechatRoom}}
						<tr class="row-link">
							<td>{{fname}}</td>
							<td>{{servedBy}}</td>
							<td>{{startedAt}}</td>
							<td>{{lastMessage}}</td>
							<td>{{status}}</td>
							{{#requiresPermission 'remove-closed-livechat-rooms'}}
								{{#if isClosed}}
									<td><a href="#remove" class="remove-livechat-room"><i class="icon-trash"></i></a></td>
								{{else}}
									<td>&nbsp;</td>
								{{/if}}
							{{else}}
								<td>&nbsp;</td>
							{{/requiresPermission}}
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
		<div class="text-center">
			<button class="button load-more">{{_ "Load_more"}}</button>
		</div>
	{{/requiresPermission}}
</template>

<template name="SearchSelect">
		<div class="rc-input" id='search-{{name}}' {{disabled}}>
			<label class="rc-input__label">
				<div class="rc-input__wrapper">
					{{# if icon}}
					<div class="rc-input__icon">
						{{> icon block="rc-input__icon-svg" icon=icon}}
					</div>
					{{/if}}
					<div class="rc-tags{{# unless icon}} rc-tags--no-icon{{/unless}}">
						{{#each item in list}} {{> tag item}} {{/each}}
						<input type="text" id="{{name}}" class="rc-tags__input" placeholder="{{_ placeholder}}" name="{{name}}" autocomplete="off" {{disabled}} />
					</div>
				</div>
				{{#with config}} {{#if autocomplete 'isShowing'}}
				<div class="dropdown-in">
					{{#if autocomplete 'isLoaded'}}
						{{> popupList data=config items=items}}
					{{/if}}
				</div>
				{{/if}} {{/with}}
			</label>
		</div>
	</template>
